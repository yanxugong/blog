<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>「工程化」如何看待构建工具 Vite？ | Yanxu Gong&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/blog/favicon.ico">
    <meta name="description" content="Personal blog based on Github Action + Vuepress">
    
    <link rel="preload" href="/blog/assets/css/0.styles.fe7b8328.css" as="style"><link rel="preload" href="/blog/assets/js/app.800fe2b0.js" as="script"><link rel="preload" href="/blog/assets/js/2.eca0bbc3.js" as="script"><link rel="preload" href="/blog/assets/js/13.2bb24d0b.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.ceee7412.js"><link rel="prefetch" href="/blog/assets/js/11.543b8244.js"><link rel="prefetch" href="/blog/assets/js/12.cca7434b.js"><link rel="prefetch" href="/blog/assets/js/14.78813775.js"><link rel="prefetch" href="/blog/assets/js/15.eced5059.js"><link rel="prefetch" href="/blog/assets/js/16.2fd2bec1.js"><link rel="prefetch" href="/blog/assets/js/17.2857c48d.js"><link rel="prefetch" href="/blog/assets/js/18.517af3ad.js"><link rel="prefetch" href="/blog/assets/js/19.15d85cd6.js"><link rel="prefetch" href="/blog/assets/js/20.e7a7bc83.js"><link rel="prefetch" href="/blog/assets/js/21.3672733c.js"><link rel="prefetch" href="/blog/assets/js/22.9ae9830f.js"><link rel="prefetch" href="/blog/assets/js/23.b3acaf99.js"><link rel="prefetch" href="/blog/assets/js/24.52c67ab9.js"><link rel="prefetch" href="/blog/assets/js/25.2a715d69.js"><link rel="prefetch" href="/blog/assets/js/26.e39f258d.js"><link rel="prefetch" href="/blog/assets/js/27.7cd0d4c8.js"><link rel="prefetch" href="/blog/assets/js/28.cab3ae50.js"><link rel="prefetch" href="/blog/assets/js/29.bd82d29f.js"><link rel="prefetch" href="/blog/assets/js/3.8e78d6c3.js"><link rel="prefetch" href="/blog/assets/js/30.d27bba02.js"><link rel="prefetch" href="/blog/assets/js/31.8c2f7bc7.js"><link rel="prefetch" href="/blog/assets/js/32.a1c8dd9e.js"><link rel="prefetch" href="/blog/assets/js/4.3a92aa40.js"><link rel="prefetch" href="/blog/assets/js/5.a2a1871d.js"><link rel="prefetch" href="/blog/assets/js/6.3179d0e2.js"><link rel="prefetch" href="/blog/assets/js/7.4dfaa3fb.js"><link rel="prefetch" href="/blog/assets/js/8.bd87ed77.js"><link rel="prefetch" href="/blog/assets/js/9.939969b8.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.fe7b8328.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Yanxu Gong's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/study/" class="nav-link router-link-active">
  学习
</a></div><div class="nav-item"><a href="/blog/photography/" class="nav-link">
  摄影
</a></div><div class="nav-item"><a href="/blog/emotion/" class="nav-link">
  情感
</a></div><div class="nav-item"><a href="/blog/about.html" class="nav-link">
  关于
</a></div> <a href="https://github.com/yanxugong/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/study/" class="nav-link router-link-active">
  学习
</a></div><div class="nav-item"><a href="/blog/photography/" class="nav-link">
  摄影
</a></div><div class="nav-item"><a href="/blog/emotion/" class="nav-link">
  情感
</a></div><div class="nav-item"><a href="/blog/about.html" class="nav-link">
  关于
</a></div> <a href="https://github.com/yanxugong/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav> <div class="carbon-ads"></div> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>学习</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/study/js-basis/you-do-not-konw-js.html" class="sidebar-link">你不知道的 JavaScript（中卷）</a></li><li><a href="/blog/study/js-basis/you-do-not-konw-js-down.html" class="sidebar-link">你不知道的 JavaScript（下卷）</a></li><li><a href="/blog/study/js-basis/variables-and-types.html" class="sidebar-link">「重学 JavaScript」变量和类型</a></li><li><a href="/blog/study/js-basis/prototype-and-prototype-chain.html" class="sidebar-link">「重学 JavaScript」原型和原型链</a></li><li><a href="/blog/study/js-basis/scope-and-closure.html" class="sidebar-link">「重学 JavaScript」作用域和闭包</a></li><li><a href="/blog/study/js-basis/implementation-mechanism.html" class="sidebar-link">「重学 JavaScript」执行机制</a></li><li><a href="/blog/study/js-basis/syntax-and-api.html" class="sidebar-link">「重学 JavaScript」语法和 API</a></li><li><a href="/blog/study/frame/deep-react-one.html" class="sidebar-link">深入 react 技术栈（一）</a></li><li><a href="/blog/study/frame/deep-react-two.html" class="sidebar-link">深入 react 技术栈（二）</a></li><li><a href="/blog/study/network/from-url-to-page-render.html" class="sidebar-link">说一说从 URL 输入到页面呈现到底发生了什么？</a></li><li><a href="/blog/study/algorithm/linked-list.html" class="sidebar-link">「重学算法」快速掌握链表题</a></li><li><a href="/blog/study/performance-optimization/first-screen.html" class="sidebar-link">「性能优化」首屏时间指标到底如何采集？</a></li><li><a href="/blog/study/engineering/vite.html" aria-current="page" class="active sidebar-link">「工程化」如何看待构建工具 Vite？</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/study/engineering/vite.html#一、vite-是什么" class="sidebar-link">一、Vite 是什么？</a></li><li class="sidebar-sub-header"><a href="/blog/study/engineering/vite.html#二、vite-怎么玩" class="sidebar-link">二、Vite 怎么玩？</a></li><li class="sidebar-sub-header"><a href="/blog/study/engineering/vite.html#三、vite-为什么快" class="sidebar-link">三、Vite 为什么快？</a></li><li class="sidebar-sub-header"><a href="/blog/study/engineering/vite.html#四、什么是-esbuild" class="sidebar-link">四、什么是 esbuild？</a></li><li class="sidebar-sub-header"><a href="/blog/study/engineering/vite.html#五、未来构建工具展望" class="sidebar-link">五、未来构建工具展望</a></li><li class="sidebar-sub-header"><a href="/blog/study/engineering/vite.html#六、感谢" class="sidebar-link">六、感谢</a></li></ul></li><li><a href="/blog/study/engineering/webpack-loader.html" class="sidebar-link">「webpack 核心特性」loader</a></li><li><a href="/blog/study/engineering/webpack-plugin.html" class="sidebar-link">「webpack 核心特性」插件(plugin)</a></li><li><a href="/blog/study/engineering/webpack-main.html" class="sidebar-link">「webpack 核心特性」工作原理</a></li><li><a href="/blog/study/engineering/webpack-hmr.html" class="sidebar-link">「webpack 核心特性」模块热替换(HMR)</a></li><li><a href="/blog/study/server/go-getting-started.html" class="sidebar-link">Go 快速入门指南</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="「工程化」如何看待构建工具-vite"><a href="#「工程化」如何看待构建工具-vite" class="header-anchor">#</a> 「工程化」如何看待构建工具 Vite？</h1> <h2 id="一、vite-是什么"><a href="#一、vite-是什么" class="header-anchor">#</a> 一、Vite 是什么？</h2> <p>Vite（法语意为“迅速”，发音/vit/）是一种全新的前端构建工具。你可以把它理解为一个开箱即用的<strong>开发服务器</strong> + <strong>打包工具</strong>的组合，但是更轻更快。 Vite 利用浏览器原生的 ES 模块支持和用编译到原生的语言开发的工具（如 esbuild）来提供一个快速且现代的开发体验。</p> <h2 id="二、vite-怎么玩"><a href="#二、vite-怎么玩" class="header-anchor">#</a> 二、Vite 怎么玩？</h2> <blockquote><p><strong>兼容性注意</strong></p> <p>Vite 需要 Node.js 版本 &gt;= 12.0.0。</p></blockquote> <p>使用 NPM：</p> <div class="language-js extra-class"><pre class="language-js"><code>npm init @vitejs<span class="token operator">/</span>app
</code></pre></div><p>使用 Yarn：</p> <div class="language-js extra-class"><pre class="language-js"><code>yarn init @vitejs<span class="token operator">/</span>app
</code></pre></div><p>这里我选择了默认项目名称、 <code>vue-ts</code> 模板（这里 Vue 版本为 3.0 ），然后按照提示，下一步下一步即可，如下图：</p> <p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/74830bca33b74d3c84809ef1d60a7b93~tplv-k3u1fbpfcp-watermark.image" alt="vite1.png"></p> <p>项目目录如下图：</p> <p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8fbe78caa8f5471bb5c8e25c61dcfd6d~tplv-k3u1fbpfcp-watermark.image" alt="vite2.png"></p> <p>输入指令，秒启动：</p> <div class="language-js extra-class"><pre class="language-js"><code>cd vite<span class="token operator">-</span>project
npm install
npm run dev
</code></pre></div><p>大家也跑起来玩一下吧。😂</p> <h2 id="三、vite-为什么快"><a href="#三、vite-为什么快" class="header-anchor">#</a> 三、Vite 为什么快？</h2> <h3 id="_3-1-极速的服务启动"><a href="#_3-1-极速的服务启动" class="header-anchor">#</a> 3.1 极速的服务启动</h3> <p>Vite 使用 <a href="https://esbuild.github.io/" target="_blank" rel="noopener noreferrer">esbuild<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 预构建<strong>依赖</strong>，以原生 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules" target="_blank" rel="noopener noreferrer">ESM<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 方式服务<strong>源码</strong>。</p> <p>Vite 将有许多内部模块的 ESM 依赖关系转换为单个模块，以提高后续页面加载性能。例如，我们从同一个模块引入多个单独的文件 <code>import { debounce } from 'lodash-es'</code> 时，Vite 会通过预构建 <code>lodash-es</code>（内置模块较多） 成一个模块，<strong>避免</strong>大量请求在浏览器造成<strong>网络阻塞</strong>。</p> <p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/832c27e603704861ad243caaf795bd15~tplv-k3u1fbpfcp-watermark.image" alt="2.gif"></p> <p>Esbuild 使用 Go 编写，比 JavaScript 编写的打包器预构建依赖快 10-100 倍。</p> <p>Vite 只在浏览器请求源码时进行转换并<strong>按需</strong>提供源码。<strong>动态导入</strong>的代码，只在当前屏幕上实际使用时才会被处理。</p> <h3 id="_3-2-轻量快速的热重载"><a href="#_3-2-轻量快速的热重载" class="header-anchor">#</a> 3.2 轻量快速的热重载</h3> <blockquote><p><strong>注意</strong></p> <p>手动 HMR API 主要用于框架和工具作者。作为最终用户，HMR 可能已经在特定于框架的启动器模板中为你处理过了。</p></blockquote> <p>Vite 提供了一套原生 ESM 的 <a href="https://cn.vitejs.dev/guide/api-hmr.html" target="_blank" rel="noopener noreferrer">HMR API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。 具有 HMR 功能的框架可以利用该 API 提供即时、准确的更新，而无需重新加载页面或删除应用程序状态。</p> <h2 id="四、什么是-esbuild"><a href="#四、什么是-esbuild" class="header-anchor">#</a> 四、什么是 esbuild？</h2> <h3 id="_4-1-官网描述"><a href="#_4-1-官网描述" class="header-anchor">#</a> 4.1 官网描述</h3> <p>一个极速 JavaScript 打包工具。</p> <h3 id="_4-2-主要特点"><a href="#_4-2-主要特点" class="header-anchor">#</a> 4.2 主要特点</h3> <ul><li>极快的速度，无需缓存</li> <li>ES6 和 CommonJS 模块</li> <li>ES6 模块的 Tree shaking</li> <li>适用于 JavaScript 和 Go 的 API</li> <li>TypeScript 和 JSX 语法</li> <li>Source maps</li> <li>压缩</li> <li>Plugins</li></ul> <h3 id="_4-3-存在的问题"><a href="#_4-3-存在的问题" class="header-anchor">#</a> 4.3 存在的问题</h3> <ul><li>调试麻烦</li></ul> <p>esbuild 的核心代码是用 golang 编写，用户使用的直接是编译出来的 binary 代码和一堆 js 代码，binary 代码几乎没法断点调试，每次调试 esbuild 的代码，需要拉下代码重新编译调试，调试要求较高，难度较大。</p> <ul><li>只支持 es6</li></ul> <p>目前国内大部分都仍然需要考虑 es5 场景，因此并不能将 esbuild 的产物作为最终产物，通常需要做 es6 到 es5 的转换。</p> <blockquote><p>WebAssembly 也叫 WASM，它是为基于栈的虚拟机设计的二进制指令格式，WASM 作为可移植目标，用于编译高级语言（如 C/C++/Rust），从而可以在 Web 上部署高性能客户端和服务器应用，同时它也可以在许多其它环境中使用。</p></blockquote> <blockquote><p>WebAssembly 描述了一种内存安全的沙箱执行环境，该环境甚至可以在现有 JavaScript 虚拟机内部实现。当嵌入到 Web 中时，WebAssembly 将强制执行浏览器的同源和权限安全策略。</p></blockquote> <ul><li>golang wasm 的性能相比 native 有较大的损耗，且 wasm 包体积较大，</li></ul> <p>目前 golang 编译出的 wasm 性能并不是很好（相比于 native 有 3-5 倍的性能衰减），并且 go 编译出来 wasm 包体积较大( 8M+ )，不太适合一些对包体积敏感的场景（比如生产环境）。</p> <ul><li>插件机制缺失</li></ul> <h2 id="五、未来构建工具展望"><a href="#五、未来构建工具展望" class="header-anchor">#</a> 五、未来构建工具展望</h2> <p>相信玩过 Vite 的同学们都被它的<strong>首次启动秒开</strong>，<strong>极速热启动</strong>等等优势深深的吸引到了。个人感觉这个方向还是非常潜力的。</p> <p>前端玩具层出不穷，敢问路在何方？</p> <p>种一棵树最好的时间是十年前，其次是<strong>现在</strong>。一起玩一玩 Vite 吧。</p> <h2 id="六、感谢"><a href="#六、感谢" class="header-anchor">#</a> 六、感谢</h2> <ul><li>如果这篇文章对你有帮助，就点个赞支持下吧！感谢阅读。</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/yanxugong/blog/edit/main/docs/study/engineering/vite.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">4/20/2021, 3:05:54 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/study/performance-optimization/first-screen.html" class="prev">
        「性能优化」首屏时间指标到底如何采集？
      </a></span> <span class="next"><a href="/blog/study/engineering/webpack-loader.html">
        「webpack 核心特性」loader
      </a>
      →
    </span></p></div> <div class="bsa-cpc-wrapper"><div class="bsa-cpc"></div></div></main></div><div class="global-ui"><div></div><!----></div></div>
    <script src="/blog/assets/js/app.800fe2b0.js" defer></script><script src="/blog/assets/js/2.eca0bbc3.js" defer></script><script src="/blog/assets/js/13.2bb24d0b.js" defer></script>
  </body>
</html>
